rue <- "Rue Gaspard Toto"
gsub("^.*\\.(.*)$", "\\1", rue)
library(tidyverse)
library(sf)
library(geojsonsf)
library(stringdist)
library(glue)
library(jsonlite)
library(stringi)
library(lubridate)
library(shiny)
source("../helpers/imports/main.R")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
source("../helpers/imports/geocode.R")
source("../shinyapps/shinyapp/helpers/geocode.R", encoding = "UTF-8")
inputCSV <- "../../../schema-arrete-permanent-circulation-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(input   = inputCSV,
streets = streets,
output = "../../outputs/arrete-cassis2.csv")
library(tidyverse)
library(sf)
library(geojsonsf)
library(stringdist)
library(glue)
library(jsonlite)
library(stringi)
library(lubridate)
library(shiny)
source("../helpers/imports/main.R")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
source("../helpers/imports/geocode.R")
inputCSV <- "../../../schema-arrete-permanent-circulation-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../../outputs/arrete-cassis2.csv")
source("../helpers/imports/main.R")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
source("../helpers/imports/geocode.R")
inputCSV <- "../../../schema-arrete-permanent-circulation-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../../outputs/arrete-cassis2.csv")
source("../helpers/imports/main.R")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
source("../helpers/imports/geocode.R")
inputCSV <- "../../../schema-arrete-permanent-circulation-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../../outputs/arrete-cassis2.csv")
inputCSV <- "../../schema-arrete-permanent-circulation-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../../outputs/arrete-cassis2.csv")
inputCSV <- "../../schema-arrete-circulation-marchandises-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../../outputs/arrete-cassis2.csv")
inputCSV <- "../../schema-arrete-circulation-marchandises-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../outputs/arrete-cassis2.csv")
source("../helpers/imports/geocode.R")
inputCSV <- "../../schema-arrete-circulation-marchandises-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(inputFile   = inputCSV,
streets = streets,
outputFile  = "../outputs/arrete-cassis2.csv")
source("../helpers/imports/geocode.R")
inputCSV <- "../../schema-arrete-circulation-marchandises-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(input   = inputCSV,
streets     = streets,
output  = "../outputs/arrete-cassis2.csv")
read.csv("../../outputs/arrete-cassis2.csv", sep=",", encoding = "UTF-8") %>% names
read.csv("../outputs/arrete-cassis2.csv", sep=",", encoding = "UTF-8") %>% names
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
csv2md(inputFile = inputCSV, outputFile = "../outputs/arrete-cassis.md")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
csv2md(input  = inputCSV,
output = "../outputs/arrete-cassis.md")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
csv2html(input = inputCSV, output = "../outputs/cassis.html")
input  <- "../outputs/arrete-cassis2.csv" # CSV géocodé
output <- "../outputs/arrete-cassis.gpkg"
file.exists(input)
file.exists(output)
source("../helpers/imports/geocode.R", encoding = "UTF-8")
input  <- "../outputs/arrete-cassis2.csv" # CSV géocodé
file.exists(input)
arrete2gpkg(input   = input,
output  = "../outputs/arrete-cassis.gpkg",
wkt_col = "X_GEOM_WKT")
source("../helpers/imports/geocode.R", encoding = "UTF-8")
input  <- "../outputs/arrete-cassis2.csv" # CSV géocodé
file.exists(input)
arrete2gpkg(input   = input,
output  = "../outputs/arrete-cassis.gpkg",
geom_col = "X_GEOM_WKT")
sf_rues <- read_streets("../data/13022-Cassis.geojson")
sf_rues$name
sf_rues <- read_streets("../data/13022-Cassis.geojson")
get_rues(sf_rues, "Chemain du Plan d'Ollive")
sf_rues <- read_streets("../data/13022-Cassis.geojson")
res <- get_rues(sf_rues, "Chemain du Plan d'Ollive")
wkt <- res$wkt
distance <- res$distance
print(wkt)
street <- "Chemain du Plan d'Ollive, Charles de Gaulle"
street <- "Chemain du Plan d'Ollive, Charles de Gaulle"
strsplit(street, ",")[[1]]
strsplit(street, ",")[[1]] %>% trimws(which="both")
street <- strsplit(street, ",")[[1]] %>% trimws(which="both")
street
res <- get_rues(sf_rues, street)
res
geocodeStreet <- function(street, streetsFile) {
if(!file.exists(streetsFile)) {
stop("Fichier de rues ,", streetsFile, " inexistant")
}
SearchAndRender <- function(street, sf_rues) {
message(">> Géométrie de la rue ", street, " :")
res <- get_rues(sf_rues, street)
wkt <- res$wkt
distance <- res$distance
message(wkt)
}
sf_rues <- read_streets(streetsFile)
if(grepl(",", street)) {
streets <- strsplit(street, ",")[[1]] %>% trimws(which="both")
for(street in streets) {
SearchAndRender(street, sf_rues)
}
} else {
SearchAndRender(street, sf_rues)
}
}
geocodeStreet(street = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
geocodeStreet(street = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
CSV2HTML(input = inputCSV, output = "../outputs/cassis.html")
source("../helpers/imports/geocode.R", encoding = "UTF-8")
input  <- "../outputs/arrete-cassis2.csv" # CSV géocodé
file.exists(input)
CSV2GPKG(input   = input,
output  = "../outputs/arrete-cassis.gpkg",
geom_col = "X_GEOM_WKT")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
CSV2HTML(input = inputCSV, output = "../outputs/cassis.html")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
CSV2MD(input  = inputCSV,
output = "../outputs/arrete-cassis.md")
source("../helpers/imports/markdown.R")
source("../helpers/imports/opening-hours.R")
CSV2HTML(input = inputCSV, output = "../outputs/cassis.html")
source("../helpers/imports/geocode.R")
inputCSV <- "../../schema-arrete-circulation-marchandises-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(input   = inputCSV,
streets = streets,
output  = "../outputs/arrete-cassis2.csv")
source("../helpers/imports/geocode.R")
inputCSV <- "../../schema-arrete-circulation-marchandises-private/Cassis/arrete-cassis.csv"
file.exists(inputCSV)
# streets <- "https://raw.githubusercontent.com/mrajerisonCerema/streets-as-geojson/master/OSM/PROVENCE%20ALPES%20COTE%20D%20AZUR/13022-Cassis.geojson"
streets <- "../data/13022-Cassis.geojson"
file.exists(streets)
geocodeCSV(input   = inputCSV,
streets = streets,
output  = "../outputs/arrete-cassis2.csv")
source("../helpers/main.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chemain du Plan d'Ollive, Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chemain du Plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chem. du Plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
source("../helpers/main.R")
source("../helpers/imports/geocode.R")
geocodeStreet(street      = "Chem. du plan d'Ollive, esplanade Charles de Gaulle",
streetsFile = "../data/13022-Cassis.geojson")
rm(list=ls())
